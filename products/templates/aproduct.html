{% extends 'base.html' %}
{% block content %}

<div class="container">
	<div class="row">
		<div class="col">
			<h3>{{ product.name }}</h3>
            <p><img class="product" src="{{ MEDIA_URL }}{{ product.image }}"></p>
			<p>{{ product.description }}</p>
			<p>{{ product.price }}</p>
            {% for star in stars %}
                {% if star.avg_review %}
                    <div class="div">
                       {% include 'components/starrating.html' %} 
                    </div>
                    {% else %}
                    <div class="div">
                        <h4>No reviews yet for this product</h4>
                    </div>
                {% endif %} 
            {% endfor %}
		</div>
	</div>

    <div class="row">
        <div class="col-md-4">
            <div class="form-group">
            <label>Size</label>
            <select name="size" class="selectpicker" data-title="Select size" data-style="btn-default btn-block" data-menu-style="dropdown-blue">
            {% for x,y in form.fields.size.choices %}
            <option value="{{ x }}">{{ y }}</option>
            {% endfor %}
            </select>
        </div>  
        </div>
    </div>



    <div class="row my-2">
        <div class="col-12">
            <form method="post" action="{% url 'cart_add' product.id %}">
                {% csrf_token %}
                <div class="input-group">
                    <input name="quantity" type="number" min="1" max="99" required>
                    <span class="input-group-btn">
                    <button class="btn-outline-success" type="submit">Add to Cart</button>
                    </span>
                </div>
            </form>
        </div>
    </div>
    <div class="row my-2">
        <div class="col-12">
            <a href="{% url 'review_prod' product.id %}" class="btn btn-primary btn-lg active" role="button"
                aria-pressed="true">Add Review</a>
        </div>
    </div>
</div>


    {% if product.productreview_set.count == 0 %}
        <h3>No reviews for this product</h3>
    {% elif product.productreview_set.count == 1 %}
        <h3>{{ product.productreview_set.count }} review for product</h3>
    {% elif product.productreview_set.count > 1 %}
        <h3>{{ product.productreview_set.count }} Product Reviews</h3>
    {% endif %}

{% for review in product.productreview_set.all %}
    <h3>{{ review.title }}</h3>
	<p>{{ review.content }}</p>
	<p>{{ review.user }}</p>
    <p>{{ review.date }}</p>
    <p>"{{ review.product }}"</p>
    <p>"{{ review.rating }}/5"</p>
    {% if review.user == user %}
        <a href="{% url 'delete_prod_review' review.id %}" class="btn btn-danger">delete review</a>
        <a href="{% url 'edit_review_prod' review.id  %}" class="btn btn-warning">edit review</a>
    {% endif %}
{% endfor %}



{% endblock %}